<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ENE-LOG - Ryuo's Wisdom</title>
    <style>
        :root {
            --seiryu-blue: #00e5ff;
            --deep-blue: #001a33;
            --agri: #4CAF50; --skill: #673AB7; --space: #FF9800; --person: #e91e63;
            --header-height: 60px; --nav-height: 75px;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body, html { width: 100%; height: 100%; font-family: 'Hiragino Mincho ProN', serif; overflow: hidden; background: var(--deep-blue); }

        /* --- Framework --- */
        header { position: fixed; top: 0; width: 100%; height: var(--header-height); background: rgba(255,255,255,0.95); backdrop-filter: blur(10px); display: flex; align-items: center; justify-content: space-between; padding: 0 15px; z-index: 3000; border-bottom: 1px solid #ddd; }
        .view { display: none; width: 100%; height: calc(100vh - var(--header-height) - var(--nav-height)); margin-top: var(--header-height); position: relative; overflow-y: auto; background: #f0f4f8; }
        .view.active { display: block; }

        /* --- Ryuo View (Deep Dark) --- */
        #ryuo-view { background: radial-gradient(circle at center, #003366 0%, #000 100%); color: white; padding: 20px; }
        .ryuo-spirit { font-size: 60px; margin-top: 30px; animation: float 4s infinite ease-in-out; display: inline-block; }
        @keyframes float { 0%, 100% { transform: translateY(0) scale(1); filter: drop-shadow(0 0 10px var(--seiryu-blue)); } 50% { transform: translateY(-15px) scale(1.1); filter: drop-shadow(0 0 25px var(--seiryu-blue)); } }
        
        .wisdom-paper { background: rgba(255,255,255,0.05); border: 1px solid rgba(0,229,255,0.3); border-radius: 20px; padding: 25px; margin-top: 30px; backdrop-filter: blur(10px); min-height: 150px; position: relative; }
        .wisdom-text { font-size: 0.95rem; line-height: 1.8; text-align: left; opacity: 0; transition: 1.5s; }
        .wisdom-text.reveal { opacity: 1; }
        .wisdom-sign { margin-top: 20px; text-align: right; font-size: 0.8rem; color: var(--seiryu-blue); border-top: 1px solid rgba(0,229,255,0.2); padding-top: 10px; }

        /* --- Elements --- */
        .node { position: absolute; transform: translate(-50%, -50%); width: 44px; height: 48px; clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%); display: flex; align-items: center; justify-content: center; font-size: 18px; color: white; }
        .table-container { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; padding: 15px; }
        .item-card { background: white; border-radius: 12px; padding: 10px; margin-bottom: 8px; border-left: 5px solid #ccc; font-size: 0.7rem; color: #333; }
        
        nav { position: fixed; bottom: 0; width: 100%; height: var(--nav-height); background: var(--deep-blue); display: flex; align-items: center; z-index: 4000; padding-bottom: 10px; }
        .nav-btn { flex: 1; color: white; border: none; background: none; display: flex; flex-direction: column; align-items: center; font-size: 0.6rem; opacity: 0.4; }
        .nav-btn.active { opacity: 1; color: var(--seiryu-blue); }
    </style>
</head>
<body>

    <header>
        <div style="font-weight:bold; font-size:0.7rem; margin-left:10px;">ğŸ’  ENE-LOG</div>
        <div style="font-size:0.6rem; color:#666; margin-right:10px;">é¾ç‹ã®æ™ºæ…§ Ver 1.0</div>
    </header>

    <div id="home-view" class="view active">
        <div id="map-area" style="width:100%; height:100%; background:#07192f;"></div>
    </div>

    <div id="table-view" class="view">
        <div class="table-container">
            <div class="table-col"><div style="color:#000; font-size:0.7rem; font-weight:bold; margin-bottom:10px;">ğŸ¥˜ æŒã¡å¯„ã‚Š</div><div id="off-list"></div></div>
            <div class="table-col"><div style="color:#000; font-size:0.7rem; font-weight:bold; margin-bottom:10px;">ğŸ½ ãƒªã‚¯ã‚¨ã‚¹ãƒˆ</div><div id="req-list"></div></div>
        </div>
    </div>

    <div id="ryuo-view" class="view">
        <div style="text-align:center;">
            <div class="ryuo-spirit">ğŸ²</div>
            <h2 style="color:var(--seiryu-blue); letter-spacing:5px; margin-top:10px;">é¾ç‹ã®æ™ºæ…§</h2>
            
            <div class="wisdom-paper">
                <div id="wisdom-content" class="wisdom-text">...ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’èª­ã¿è§£ã„ã¦ã„ã¾ã™...</div>
                <div class="wisdom-sign">è¦³æ¸¬è€…ï¼šKUKAI</div>
            </div>
            
            <button onclick="invokeWisdom()" style="margin-top:30px; background:none; border:1px solid var(--seiryu-blue); color:var(--seiryu-blue); padding:12px 30px; border-radius:30px; font-weight:bold; cursor:pointer;">æ™ºæ…§ã‚’æˆã‹ã‚‹</button>
        </div>
    </div>

    <nav>
        <button class="nav-btn active" onclick="switchView('home-view', this)">ğŸ—º<span>Map</span></button>
        <button class="nav-btn" onclick="switchView('table-view', this)">ğŸ¥˜<span>Table</span></button>
        <button class="nav-btn" onclick="switchView('ryuo-view', this)">ğŸ²<span>é¾ç‹</span></button>
    </nav>

<script>
    // è“„ç©ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ï¼ˆå°†æ¥çš„ã«APIã§ä¿å­˜ãƒ»å–å¾—ã•ã‚Œã‚‹éƒ¨åˆ†ï¼‰
    let db = [
        { type:'agri', mode:'give', title:'ç´è±†èŒã®çŸ¥è¦‹', icon:'ğŸŒ±' },
        { type:'person', mode:'give', title:'Tableæ¡ˆå†…', icon:'ğŸ‘¤' },
        { type:'skill', mode:'want', title:'é‡å­åŠ›å­¦ã®ç†è§£', icon:'ğŸ’¡' }
    ];

    function switchView(id, btn) {
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        if(id === 'ryuo-view') invokeWisdom();
        if(id === 'home-view') render();
        if(id === 'table-view') render();
    }

    // --- é¾ç‹ã®æ™ºæ…§ãƒ­ã‚¸ãƒƒã‚¯ ---
    function invokeWisdom() {
        const content = document.getElementById('wisdom-content');
        content.classList.remove('reveal');
        
        // ãƒ‡ãƒ¼ã‚¿ã®åˆ†æ
        const gives = db.filter(i => i.mode === 'give').length;
        const wants = db.filter(i => i.mode === 'want').length;
        const mainCat = db[0]?.type || 'none';

        let message = "";
        
        if (db.length === 0) {
            message = "ã¾ã æµ·é¢ã¯é™ã‹ã§ã™ã€‚ã¾ãšã¯ã‚ãªãŸã¨ã„ã†çŸ³ã‚’æŠ•ã˜ãªã•ã„ã€‚å°ã•ãªã€æŒã¡å¯„ã‚Šã€ã‹ã‚‰ã€å…¨ã¦ã®æ³¢ç´‹ã¯å§‹ã¾ã‚Šã¾ã™ã€‚";
        } else if (gives > wants) {
            message = `ã‚ãªãŸã®ã€ŒæŒã¡å¯„ã‚‹ã€ã‚¨ãƒãƒ«ã‚®ãƒ¼ãŒæº€ã¡ã¦ã„ã¾ã™ã€‚${db[0].title}ã¨ã„ã†é±—ã¯ã€èª°ã‹ã®æ¸‡ãã‚’ç™’ã™ã§ã—ã‚‡ã†ã€‚æ¬¡ã¯ã‚ãˆã¦ã€Œæ±‚ã‚ã‚‹ã€ã“ã¨ã§ã€ä»–è€…ãŒè¼ãç©ºï¼ˆãã†ï¼‰ã‚’ä½œã‚Šãªã•ã„ã€‚`;
        } else if (wants >= gives) {
            message = "æ±‚ã‚ã‚‹å¿ƒã¯ã€æ–°ã—ã„çŸ¥æµã‚’å‘¼ã³è¾¼ã‚€é–€ã§ã™ã€‚ã—ã‹ã—ã€ç©ºã£ã½ã®å™¨ã«æ°´ã¯æºœã¾ã‚Šã¾ã›ã‚“ã€‚${db[0].title}ã¸ã®æ¸‡æœ›ã‚’ã€å°‘ã—ã®ã€ŒæŒã¡å¯„ã‚Šã€ã«å¤‰ãˆã¦ã”ã‚‰ã‚“ãªã•ã„ã€‚å¾ªç’°ãŒå§‹ã¾ã‚Šã¾ã™ã€‚";
        } else {
            message = "èª¿å’Œã¯ä¿ãŸã‚Œã¦ã„ã¾ã™ã€‚ä»Šã®ã‚ãªãŸã¯ã€æ±åºƒå³¶ã®åœŸå£Œã¨æ·±ãå…±é³´ã—ã¦ã„ã¾ã™ã€‚ãã®ã¾ã¾ã€ç›®ã®å‰ã®ã‚¢ãƒä½“é¨“ã‚’è¦³æ¸¬ã—ç¶šã‘ãªã•ã„ã€‚";
        }

        setTimeout(() => {
            content.innerText = message;
            content.classList.add('reveal');
        }, 500);
    }

    function render() {
        // Map Rendering
        const map = document.getElementById('map-area');
        if(map) {
            map.innerHTML = '';
            db.forEach((item, i) => {
                const el = document.createElement('div');
                el.className = `node node--${item.type}`;
                el.innerHTML = item.icon;
                el.style.top = (30 + i*15) + '%'; el.style.left = (20 + i*20) + '%';
                map.appendChild(el);
            });
        }
        // Table Rendering
        const offList = document.getElementById('off-list');
        const reqList = document.getElementById('req-list');
        if(offList && reqList) {
            offList.innerHTML = ''; reqList.innerHTML = '';
            db.forEach(item => {
                const card = document.createElement('div');
                card.className = 'item-card';
                card.style.borderLeftColor = `var(--${item.type})`;
                card.innerHTML = `<strong>${item.icon} ${item.title}</strong>`;
                if(item.mode === 'give') offList.appendChild(card);
                else reqList.appendChild(card);
            });
        }
    }
    
    window.onload = render;
</script>
</body>
</html>
