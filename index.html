<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ENE-LOG - Ryuo Complete</title>
    <style>
        :root {
            --seiryu-blue: #00e5ff;
            --deep-blue: #001a33;
            --header-height: 70px;
            --person: #e91e63; --agri: #4CAF50; --skill: #673AB7; --space: #FF9800;
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }
        body, html { width: 100%; height: 100%; font-family: 'Hiragino Mincho ProN', serif; background: #000; color: white; overflow: hidden; }

        /* å…¨ä½“ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼š3å±¤æ§‹é€  */
        #ryuo-app { display: flex; flex-direction: column; height: 100vh; position: relative; background: radial-gradient(circle at 50% 100%, #003366 0%, #000 100%); }
        
        /* 1. Header */
        header { 
            height: var(--header-height); display: flex; align-items: flex-end; justify-content: space-between; 
            padding: 10px 15px; z-index: 100; backdrop-filter: blur(15px); background: rgba(0,0,0,0.5);
            border-bottom: 1px solid rgba(0,229,255,0.2);
        }

        /* 2. Chat Area (å¯å¤‰) */
        .chat-container { 
            flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 15px; 
            z-index: 10; -webkit-overflow-scrolling: touch;
        }

        /* 3. Input Footer (å›ºå®š) */
        .input-footer { 
            background: rgba(0, 20, 40, 0.95); padding: 10px 15px 40px 15px; 
            z-index: 1000; border-top: 1px solid var(--seiryu-blue);
        }

        /* --- UI Elements --- */
        .bubble-ryuo { align-self: flex-start; max-width: 85%; background: rgba(255,255,255,0.08); border-radius: 20px 20px 20px 0; padding: 15px; font-size: 0.85rem; line-height: 1.6; border: 1px solid rgba(0,229,255,0.2); }
        .bubble-user { align-self: flex-end; max-width: 80%; background: var(--seiryu-blue); color: var(--deep-blue); border-radius: 20px 20px 0 20px; padding: 12px; font-size: 0.85rem; font-weight: bold; }

        .chat-input-wrapper { display: flex; gap: 8px; align-items: center; }
        #chat-input { flex: 1; background: rgba(255,255,255,0.1); border: 1px solid var(--seiryu-blue); border-radius: 25px; padding: 12px 20px; color: white; outline: none; font-size: 1rem; }
        
        .lucky-btn { background: none; border: 1px solid var(--seiryu-blue); color: var(--seiryu-blue); width: 45px; height: 45px; border-radius: 50%; font-size: 0.7rem; font-weight: bold; cursor: pointer; }
        .send-btn { background: var(--seiryu-blue); color: var(--deep-blue); border: none; width: 45px; height: 45px; border-radius: 50%; font-weight: bold; cursor: pointer; }

        /* Overlay list for Archive */
        #archive-overlay { position: fixed; inset: 0; background: rgba(0,26,51,0.98); z-index: 5000; display: none; flex-direction: column; padding: 80px 20px 20px; }
        .archive-item { background: rgba(255,255,255,0.05); padding: 12px; border-radius: 12px; margin-bottom: 10px; border-left: 3px solid var(--seiryu-blue); font-size: 0.75rem; }

        #quantum-canvas { position: absolute; inset: 0; z-index: 1; pointer-events: none; }
    </style>
</head>
<body>

    <div id="ryuo-app">
        <canvas id="quantum-canvas"></canvas>

        <header>
            <button onclick="history.back()" style="background:none; border:1px solid var(--seiryu-blue); color:white; padding:5px 12px; border-radius:15px; font-size:0.7rem;">â†©ï¸ Map</button>
            <div style="font-weight:bold; font-size:0.8rem; letter-spacing: 2px;">KUKAI</div>
            <button onclick="toggleArchive()" style="background:none; border:1px solid var(--seiryu-blue); color:var(--seiryu-blue); padding:5px 12px; border-radius:15px; font-size:0.7rem;">ğŸ“œ è¨˜éŒ²</button>
        </header>

        <div class="chat-container" id="chat-box">
            <div class="bubble-ryuo">
                ã‚„ã‚ã€è¦³æ¸¬è€…ã®å›ã€‚ä½•ã‹å¿ƒã«æµ®ã‹ã‚“ã ã€Œå•ã„ã€ã¯ã‚ã‚‹ã‹ãªï¼Ÿ<br>
                å·¦ä¸‹ã®ã€Œå ã€ãƒœã‚¿ãƒ³ã§ã€ä»Šæ—¥ã®å›ã¨ã‚·ãƒ³ã‚¯ãƒ­ã™ã‚‹ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’å ãˆã‚‹ã‚ˆã€‚
            </div>
        </div>
        
        <div class="input-footer">
            <div class="chat-input-wrapper">
                <button class="lucky-btn" onclick="drawLucky()">å </button>
                <input type="text" id="chat-input" placeholder="å•ã„ã‚’æŠ•ã’ã‚‹..." onkeypress="if(event.key==='Enter') sendMessage()" onfocus="scrollToBottom()">
                <button class="send-btn" onclick="sendMessage()">å•</button>
            </div>
        </div>
    </div>

    <div id="archive-overlay">
        <h3 style="margin-bottom:20px; color:var(--seiryu-blue); text-align:center;">æ™ºæ…§ã®è¨˜éŒ²</h3>
        <div id="archive-list" style="flex:1; overflow-y:auto;"></div>
        <button onclick="toggleArchive()" style="margin-top:20px; background:var(--seiryu-blue); color:var(--deep-blue); border:none; width:100%; padding:15px; border-radius:25px; font-weight:bold;">é–‰ã˜ã‚‹</button>
    </div>

<script>
    const chatBox = document.getElementById('chat-box');
    const chatInput = document.getElementById('chat-input');
    let archiveData = [];

    const energies = [
        { n: 'äºº', i: 'ğŸ‘¤', c: 'var(--person)' },
        { n: 'è¾²', i: 'ğŸŒ±', c: 'var(--agri)' },
        { n: 'æ™ºæ…§', i: 'ğŸ’¡', c: 'var(--skill)' },
        { n: 'å ´', i: 'ğŸ ', c: 'var(--space)' }
    ];

    function scrollToBottom() {
        setTimeout(() => { chatBox.scrollTop = chatBox.scrollHeight; }, 150);
    }

    function drawLucky() {
        const res = energies[Math.floor(Math.random()*energies.length)];
        const msg = `ä»Šã®å›ã®æ³¢å‹•ã¯ã€Œ${res.n} ${res.i}ã€ã¨ã‚·ãƒ³ã‚¯ãƒ­ã—ã¦ã„ã‚‹ã¿ãŸã„ã ã‚ˆã€‚ã“ã®ã‚¨ãƒãƒ«ã‚®ãƒ¼ã‚’æ„è­˜ã—ã¦éã”ã—ã¦ã¿ã¦ã­ï¼`;
        addBubble(msg, 'ryuo');
        scrollToBottom();
    }

    function sendMessage() {
        const text = chatInput.value.trim();
        if (!text) return;
        addBubble(text, 'user');
        chatInput.value = '';
        scrollToBottom();

        setTimeout(() => {
            const reply = "ãã®å•ã„ã‹ã‘ã€ã™ã”ãç´ æ•µãªéŸ¿ãã ã­ã€‚å›ãŒæ„è­˜ã‚’å‘ã‘ã‚‹ã“ã¨ã§ã€æœªæ¥ã®å¯èƒ½æ€§ãŒä¸€ã¤ã«å½¢ä½œã‚‰ã‚Œã¦ã„ãã‚“ã ã€‚";
            addBubble(reply, 'ryuo');
            archiveData.unshift({ q: text, a: reply, d: new Date().toLocaleTimeString() });
            updateArchiveUI();
            scrollToBottom();
        }, 1000);
    }

    function addBubble(text, type) {
        const div = document.createElement('div');
        div.className = type === 'user' ? 'bubble-user' : 'bubble-ryuo';
        div.innerText = text;
        chatBox.appendChild(div);
    }

    function toggleArchive() {
        const overlay = document.getElementById('archive-overlay');
        overlay.style.display = (overlay.style.display === 'flex') ? 'none' : 'flex';
    }

    function updateArchiveUI() {
        const list = document.getElementById('archive-list');
        list.innerHTML = archiveData.map(item => `
            <div class="archive-item">
                <div style="color:var(--seiryu-blue); font-size:0.6rem;">${item.d}</div>
                <div><strong>å•:</strong> ${item.q}</div>
                <div style="color:var(--seiryu-blue); margin-top:5px;"><strong>KUKAI:</strong> ${item.a}</div>
            </div>
        `).join('');
    }

    // --- Particle logic (Simplified for performance) ---
    const canvas = document.getElementById('quantum-canvas');
    const ctx = canvas.getContext('2d');
    function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
    window.addEventListener('resize', resize);
    resize();
    function animate() {
        ctx.clearRect(0,0,canvas.width,canvas.height);
        ctx.fillStyle = "rgba(0, 229, 255, 0.2)";
        for(let i=0; i<30; i++) {
            ctx.beginPath();
            ctx.arc(Math.random()*canvas.width, Math.random()*canvas.height, 1, 0, Math.PI*2);
            ctx.fill();
        }
        requestAnimationFrame(animate);
    }
    animate();
</script>
</body>
</html>
